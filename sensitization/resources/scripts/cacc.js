!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cacc=e():t.cacc=e()}(this,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(t,e,i){"use strict";function n(t){return e.prefix_+"-"+t}Object.defineProperty(e,"__esModule",{value:!0}),e.children=e.classList=e.getAttribute=e.getTextContent=e.toggleExpertMode=e.EXPERT_MODE=e.toArray=e.getId=e.idCounter_=e.addPrefix=e.prefix_=void 0,e.prefix_="cacc",e.addPrefix=n,e.idCounter_=0,e.getId=function(){return n("Id-"+e.idCounter_++)},e.toArray=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e},e.EXPERT_MODE=!1,e.toggleExpertMode=function(){e.EXPERT_MODE=!e.EXPERT_MODE},e.getTextContent=function(t){var e=t.textContent;return" "!==e&&(e=e.replace(/^\s*/,"")),e},e.getAttribute=function(t,e){return t.getAttribute(e)||t.getAttributeNS("http://www.chemaccess.org/sre-schema",e)||t.getAttribute("sre:"+e)},function(t){function e(t,e){t.classList&&t.classList.add?t.classList.add(e):t.className?n(t.className)?t.className.baseVal+=" "+e:t.className+=" "+e:t.className=e}function i(t,e){if(t.classList&&t.classList.remove&&t.classList.remove(e),t.className){var i=t.className;n(i)?i.baseVal=i.baseVal.replace(" "+e,""):t.className=t.className.replace(" "+e,"")}}function n(t){return"string"!=typeof t}t.add=e,t.remove=i,t.toggle=function(t,o){t.classList&&t.classList.toggle?t.classList.toggle(o):t.className?!function(t,e){return-1!==(n(t)?t.baseVal:t).search(e)}(t.className,o)?e(t,o):i(t,o):t.className=o}}(e.classList||(e.classList={})),e.children=function(t){if(t.children)return Array.prototype.slice.call(t.children);for(var e=[],i=t.childNodes,n=0,o=void 0;o=i[n];n++)1===o.nodeType&&e.push(o);return e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CustomEvent=e.EventType=e.KeyCodes=void 0,function(t){t[t.RETURN=13]="RETURN",t[t.ENTER=13]="ENTER",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z"}(e.KeyCodes||(e.KeyCodes={})),function(t){t.CLICK="click",t.DBLCLICK="dblclick",t.MOUSEDOWN="mousedown",t.MOUSEUP="mouseup",t.MOUSEOVER="mouseover",t.MOUSEOUT="mouseout",t.MOUSEMOVE="mousemove",t.SELECTSTART="selectstart",t.KEYPRESS="keypress",t.KEYDOWN="keydown",t.KEYUP="keyup",t.TOUCHSTART="touchstart",t.TOUCHMOVE="touchmove",t.TOUCHEND="touchend",t.TOUCHCANCEL="touchcancel"}(e.EventType||(e.EventType={}));var n=function(){function t(t,e,i){this.src=t,this.type=e,this.callback=i,this.src=t,this.type=e,this.callback=i}return t.prototype.add=function(){this.src.addEventListener(this.type,this.callback)},t.prototype.remove=function(){this.src.removeEventListener(this.type,this.callback)},t}();e.CustomEvent=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Base=void 0;var n=i(8),o=i(18),r=i(3),s=i(29),a=function(){function t(){this.version="0.1.1",this.explorerMap={},this.molMap=s.forDocument()}return t.prototype.init=function(){for(var t in Object.keys(this.molMap).length>0&&r.documentCmlStyle(),this.molMap)this.initElement(t,this.molMap[t])},t.prototype.initElement=function(t,e){if(e.hasAttribute("has-svg")&&e.hasAttribute("has-cml")||this.redoInitElement_(t,e),"true"===e.getAttribute("has-svg")&&"true"===e.getAttribute("has-cml")){e.setAttribute("tabindex","0"),e.setAttribute("role","application");var i=e.querySelector("div.svg").children[0],s=e.querySelector("div.cml").children[0];if(i&&s){i.setAttribute("aria-hidden","true"),s.setAttribute("aria-hidden","true");var a=new o.Molecule(e,i,s);this.explorerMap[t]=new n.Explorer(a),r.moleculeStyle(a)}}},t.prototype.redoInitElement_=function(t,e){var i=function(){this.initElement(t,e)}.bind(this);setTimeout(i,500)},t.config={MSG_VISIBLE:!0,MAG_ACTIVE:!0},t}();e.Base=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.replaceStyle_=e.removeStyle_=e.addStyle_=e.svgForegroundStyle_=e.svgBackgroundStyle_=e.svgHighlightStyle_=e.svgBaseStyle_=e.nodeBackgroundStyle_=e.pickScheme=e.moleculeStyle=e.getScheme_=e.colorSchemes_=e.toggleMonochrome=e.toggleTextVisibility=e.documentCmlStyle=void 0;var n=i(0);function o(t){return e.colorSchemes_[t%e.colorSchemes_.length]}function r(t,e){var i=o(e);u(t,i.bkd),s(t.node,i.bkd),l(t,i.frgd),c(t,i.active,i.almost)}function s(t,e){t.style.backgroundColor=e}function a(t){var e="svg."+t.id,i="";i+=e+" { overflow: hidden; }",i+=e+" text { font-size: 16px; font-family: serif; }",i+=e+" text tspan[baseline-shift] { font-weight: 200; font-size: 13px; }",i+=e+" line, svg rect { stroke-width: 1.0;  stroke-linecap: round; }",i+=e+" line.cacc-active, svg g.cacc-active line { stroke-width: 3.0; }",i+=e+" line.cacc-almost, svg g.cacc-almost line { stroke-width: 2.0; }",i+=e+" g.cacc-active text { font-weight: bold; }",i+=e+" g#gridSVG g.cacc-active text { font-weight: bold; }",i+="ul.cacc-controls { list-style-type: none; }",i+="p.cacc-message.cacc-text-invisible { font-size: 1px; }",i+=e+" polyline.cacc-active, svg g.cacc-active polyline { stroke-width: 3.0; }",i+=e+" polyline.cacc-almost, svg g.cacc-almost polyline { stroke-width: 2.0; }",i+=e+" polygon.cacc-active, svg g.cacc-active polygon { stroke-width: 3.0; }",i+=e+" polygon.cacc-almost, svg g.cacc-almost polygon { stroke-width: 2.0; }",i+=e+" path.cacc-active, svg g.cacc-active path { stroke-width: 3.0; }",i+=e+" path.cacc-almost, svg g.cacc-almost path { stroke-width: 2.0; }",i+=e+" rect.cacc-active, svg g.cacc-active rect { stroke-width: 3.0; }",i+=e+" rect.cacc-almost, svg g.cacc-almost rect { stroke-width: 2.0; }",i+=e+" circle.cacc-active, svg g.cacc-active circle { stroke-width: 3.0; }",i+=e+" circle.cacc-almost, svg g.cacc-almost circle { stroke-width: 2.0; }",h(t.node,i,"cacc-base")}function c(t,e,i){var n="svg."+t.id,o="";o+=n+" line.cacc-active, g.cacc-active line { stroke: "+e+"; }",o+=n+" line.cacc-almost, g.cacc-almost line { stroke: "+i+"; }",o+=n+" g.cacc-active text { fill: "+e+"; }",o+=n+" g.cacc-almost text { fill: "+i+"; }",o+=n+" g#gridSVG g.cacc-active text { fill: "+e+"; }",o+=n+" g#gridSVG g.cacc-almost text { fill: "+i+"; }",o+=n+" polyline.cacc-active, g.cacc-active polyline { stroke: "+e+"; }",o+=n+" polyline.cacc-almost, g.cacc-almost polyline { stroke: "+i+"; }",o+=n+" polygon.cacc-active, g.cacc-active polygon { stroke: "+e+"; }",o+=n+" polygon.cacc-almost, g.cacc-almost polygon { stroke: "+i+"; }",o+=n+" path.cacc-active, g.cacc-active path { stroke: "+e+"; }",o+=n+" path.cacc-almost, g.cacc-almost path { stroke: "+i+"; }",o+=n+" rect.cacc-active, g.cacc-active rect { stroke: "+e+"; }",o+=n+" rect.cacc-almost, g.cacc-almost rect { stroke: "+i+"; }",o+=n+" circle.cacc-active, g.cacc-active circle { stroke: "+e+"; }",o+=n+" circle.cacc-almost, g.cacc-almost circle { stroke: "+i+"; }",f(t.node,o,"cacc-color-highlight")}function u(t,e){var i="svg."+t.id,n="";n+=i+" { background-color: "+e+"; }",n+=i+" g.atom rect { stroke: "+e+"; fill: "+e+"; }",n+="div.container { background-color: "+e+"; }",n+="p."+t.id+".cacc-message { background-color: "+e+"; }",n+="p."+t.id+".cacc-message.cacc-text-invisible { color: "+e+"; }",f(t.node,n,"cacc-color-background")}function l(t,e){var i="svg."+t.id,n="";n+=i+" line { stroke: "+e+"; fill: "+e+"; }",n+=i+".cacc-text-monochrome text { stroke: "+e+"; fill: "+e+"; }",n+=i+" g#gridSVG text { stroke: "+e+"; fill: "+e+"; }",n+="div.container { color: "+e+"; }",n+="p."+t.id+".cacc-message { color: "+e+"; }",n+="ul."+t.id+".cacc-controls { color: "+e+"; }",n+=i+" polyline { stroke: "+e+"; fill: "+e+"; }",n+=i+" polygon { stroke: "+e+"; fill: "+e+"; }",n+=i+" path { stroke: "+e+"; fill: "+e+"; }",n+=i+" rect { stroke: "+e+"; fill: "+e+"; }",n+=i+" circle { stroke: "+e+"; fill: "+e+"; }",f(t.node,n,"cacc-color-elements")}function h(t,e,i){var n=document.createElement("style");n.setAttribute("class",i),n.innerHTML=e,t.appendChild(n)}function p(t,e){var i=t.querySelector("style."+e);return!!i&&(t.removeChild(i),!0)}function f(t,e,i){p(t,i),h(t,e,i)}e.documentCmlStyle=function(){document.body&&h(document.body,"div.cml { display:none; }","cacc-cml")},e.toggleTextVisibility=function(t){n.classList.toggle(t,"cacc-text-invisible")},e.toggleMonochrome=function(t){n.classList.toggle(t,"cacc-text-monochrome")},e.colorSchemes_=[{frgd:"#000",bkd:"#fff",active:"#fd6",almost:"#6df"},{frgd:"#fff",bkd:"#000",active:"#fd6",almost:"#6df"},{frgd:"#3C3",bkd:"#000",active:"#fd6",almost:"#6df"},{frgd:"#ee0",bkd:"#00e",active:"#4f4",almost:"#e3e"}],e.getScheme_=o,e.moleculeStyle=function(t){a(t),r(t,0)},e.pickScheme=r,e.nodeBackgroundStyle_=s,e.svgBaseStyle_=a,e.svgHighlightStyle_=c,e.svgBackgroundStyle_=u,e.svgForegroundStyle_=l,e.addStyle_=h,e.removeStyle_=p,e.replaceStyle_=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractMagnifier=void 0;var n=i(1),o=function(){function t(t){this.magnifier=t,this.activeElement=null,this.active_=!1,this.internalEvents_=[],this.viewBox=this.magnifier.viewBox,this.setupControls()}return t.prototype.isActive=function(){return this.active_},t.prototype.toggle=function(){return this.isActive()?this.deactivate_():this.activate_(),this.isActive()},t.prototype.registerEvent=function(t,e,i){this.internalEvents_.push(new n.CustomEvent(t,e,i))},t.prototype.addEvents=function(){for(var t,e=0;t=this.internalEvents_[e];e++)t.add()},t.prototype.removeEvents=function(){for(var t,e=0;t=this.internalEvents_[e];e++)t.remove()},t.prototype.setupControls=function(){},t.prototype.addControls=function(){},t.prototype.removeControls=function(){},t.prototype.update=function(t){this.activeElement=t,this.viewBox.select(this.activeElement.getDrawnElements())},t.prototype.activate_=function(){this.active_=!0,this.addControls(),this.addEvents(),this.viewBox.zoom("cacc-active")},t.prototype.deactivate_=function(){this.removeEvents(),this.removeControls(),this.viewBox.reset(),this.active_=!1},t}();e.AbstractMagnifier=o},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.NeighbourHood=void 0;var r=i(0),s=i(24),a=i(25),c=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.neighbourhood=[],n}return o(e,t),e.prototype.complete=function(){t.prototype.complete.call(this),this.down.sort((function(t,e){return t.position-e.position}));for(var e=this.getAnnotation().querySelectorAll("neighbours neighbour"),i=0,n=void 0;n=e[i];i++)this.neighbourhood.push(new a.Neighbour(this,n))},e.prototype.getSpeech=function(){return this.getDiagram().translate(this.getMessage())},e.prototype.getMessage=function(){if(r.EXPERT_MODE){var t=r.getAttribute(this.getAnnotation(),"speech2");if(t)return t}return r.getAttribute(this.getAnnotation(),"speech")},e.prototype.getNeighbours=function(){return this.neighbourhood},e}(s.ChemObj);e.NeighbourHood=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractExplorer=void 0;var n=i(2),o=i(3),r=i(1),s=function(){function t(t){this.explorer=t,this.active_=!1,this.internalEvents_=[],this.molecule=t.molecule,this.message=this.setupMessage(),this.activeElement=this.molecule.cmlStructure.getRootElement(),this.addMessage(),this.setupControls(),this.registerMessageToggler_()}return t.prototype.isActive=function(){return this.active_},t.prototype.activate=function(){this.isActive()||(this.updateMessage(this.activeElement.getSpeech()),this.explorer.magnifier.magnifier.update(this.activeElement),this.addControls(),this.addEvents(),this.toggleActive_())},t.prototype.deactivate=function(){this.isActive()&&(this.removeEvents(),this.removeControls(),this.removeMessage(),this.explorer.magnifier.viewBox.reset(),this.toggleActive_())},t.prototype.registerEvent=function(t,e,i){this.internalEvents_.push(new r.CustomEvent(t,e,i))},t.prototype.addEvents=function(){for(var t,e=0;t=this.internalEvents_[e];e++)t.add()},t.prototype.removeEvents=function(){for(var t,e=0;t=this.internalEvents_[e];e++)t.remove()},t.prototype.setupMessage=function(){var t=this.molecule.createElement("p");return t.classList.add("explorer"),t.setAttribute("aria-live","assertive"),t.setAttribute("tabindex","-1"),t.classList.add("cacc-message"),n.Base.config.MSG_VISIBLE||t.classList.add("cacc-text-invisible"),t},t.prototype.addMessage=function(){this.molecule.node.parentNode.appendChild(this.message)},t.prototype.removeMessage=function(){this.message.textContent=""},t.prototype.updateMessage=function(t){this.message.textContent=t},t.prototype.setupControls=function(){},t.prototype.addControls=function(){},t.prototype.removeControls=function(){},t.prototype.toggleMessageVisibility_=function(){o.toggleTextVisibility(this.message)},t.prototype.toggleActive_=function(){this.active_=!this.active_},t.prototype.registerMessageToggler_=function(){this.registerEvent(this.molecule.node,r.EventType.KEYDOWN,function(t){return t.keyCode===r.KeyCodes.Z&&this.toggleMessageVisibility_(),t.stopPropagation(),!1}.bind(this))},t}();e.AbstractExplorer=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Base=void 0;var n=i(2);e.Base=n.Base},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Explorer=void 0;var n=i(0),o=i(3),r=i(1),s=i(9),a=i(16),c=i(17),u=function(){function t(t){this.explorer_=null,this.scheme=0,this.molecule=t,this.explorerPool=[new a.KeyExplorer(this),new c.MenuExplorer(this)],this.magnifier=new s.Magnifier(this),this.addExplorerActivation(),this.addColourControls()}return t.prototype.addExplorerActivation=function(){new r.CustomEvent(this.molecule.node,r.EventType.KEYDOWN,function(t){if(this.explorer_&&t.keyCode===r.KeyCodes.ESC&&(this.explorer_.deactivate(),this.explorer_=null),!this.explorer_)for(var e=0,i=void 0;i=this.explorerPool[e];e++)if(t.keyCode===i.getActivationKey()){i.activate(),this.explorer_=i,t.preventDefault();break}return t.stopPropagation(),!1}.bind(this)).add()},t.prototype.addColourControls=function(){for(var t=0,e=void 0;e=this.explorerPool[t];t++)e.registerEvent(this.molecule.node,r.EventType.KEYDOWN,function(t){switch(t.keyCode){case r.KeyCodes.T:o.toggleMonochrome(this.molecule.svg);break;case r.KeyCodes.C:o.pickScheme(this.molecule,++this.scheme);break;case r.KeyCodes.X:n.toggleExpertMode(),this.explorer_&&this.explorer_.updateMessage(this.explorer_.activeElement.getSpeech());break;case r.KeyCodes.L:this.molecule.cmlStructure.getMap().nextLanguage()&&this.explorer_&&this.explorer_.updateMessage(this.explorer_.activeElement.getSpeech())}return t.stopPropagation(),!1}.bind(this))},t}();e.Explorer=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Magnifier=void 0;var n=i(1),o=i(2),r=i(10),s=i(11),a=i(12),c=i(14),u=function(){function t(t){this.explorer=t,this.viewBox=new c.ViewBox(this.explorer.molecule.svg),this.dummy_=new r.DummyMagnifier(this),this.magnifier=this.dummy_,this.magnifierPool_=[new s.SimpleMagnifier(this),new a.StepMagnifier(this)],o.Base.config.MAG_ACTIVE&&(this.magnifier=this.magnifierPool_[1],this.magnifier.toggle()),this.addMagnifierActivation()}return t.prototype.addMagnifierActivation=function(){for(var t=this.magnifierPool_.map(function(t){return function(e){return e.keyCode===t.getActivationKey()&&(this.magnifier!==t&&this.magnifier.toggle(),this.magnifier=t.toggle()?t:this.dummy_),e.stopPropagation(),!1}.bind(this)}.bind(this)),e=function(e,o){t.forEach(function(t){o.registerEvent(this.explorer.molecule.node,n.EventType.KEYDOWN,t)}.bind(i))},i=this,o=0,r=void 0;r=this.explorer.explorerPool[o];o++)e(0,r)},t}();e.Magnifier=u},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.DummyMagnifier=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getActivationKey=function(){return null},e}(i(4).AbstractMagnifier);e.DummyMagnifier=r},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleMagnifier=void 0;var r=i(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.update=function(t){this.activeElement=t,this.viewBox.select(this.activeElement.getDrawnElements()),this.viewBox.zoom("cacc-active")},e.prototype.timedUpdate=function(t){this.activeElement&&this.viewBox.select(t.getDrawnElements(),"cacc-almost"),setTimeout(function(){this.activeElement=t,this.viewBox.select([],"cacc-almost"),this.viewBox.select(this.activeElement.getDrawnElements(),"cacc-active")}.bind(this),2e3)},e.prototype.getActivationKey=function(){return r.KeyCodes.M},e}(i(4).AbstractMagnifier);e.SimpleMagnifier=s},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.StepMagnifier=void 0;var r=i(13),s=i(1),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sonify=!1,e}return o(e,t),e.prototype.update=function(t){var e=this.activeElement?this.activeElement.getDrawnElements():[];this.viewBox.select(t.getDrawnElements(),"cacc-almost"),this.viewBox.select(t.getDrawnElements().concat(e),"cacc-dummy"),this.activeElement=t,this.viewBox.zoom("cacc-dummy",{duration:250,delay:25,wait:300,callback:function(){this.sonify&&r.Sonify.sonify(this.activeElement),this.viewBox.select([],"cacc-almost"),this.viewBox.select(this.activeElement.getDrawnElements(),"cacc-active"),this.viewBox.zoom("cacc-active",{duration:250,delay:25,wait:300})}.bind(this)})},e.prototype.getActivationKey=function(){return s.KeyCodes.N},e}(i(4).AbstractMagnifier);e.StepMagnifier=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sonify=void 0;var n=i(0),o=function(){function t(t){this.path=[],this.points=[],this.context=new AudioContext,this.prepare(t),this.sonifiable=this.path.length}return t.sonify=function(e){var i=e.getAnnotation().querySelectorAll("sonification > *"),o=[];i.length&&(o=Array.from(i).map(function(t){var i=n.getTextContent(t),o=i+("ACTIVE"!==t.tagName&&"sre:active"!==t.tagName?"":i===e.getId()?e.getParent():e.getId());return e.getDiagram().get(o)}.bind(this)));var r=new t(o);r.sonifiable&&r.sonify()},t.prototype.prepare=function(t){for(var e=0,i=void 0;i=t[e];e++)if(i.getDrawnElement()){for(var n=i.getDrawnElement().querySelectorAll("polyline,path"),o=0;o<n.length;o++){var r=n[o];this.path.push(r);for(var s=0;s<r.points.length;s++)this.points.push([r.points[s].x,r.points[s].y])}n=i.getDrawnElement().querySelectorAll("rect");for(o=0;o<n.length;o++){r=n[o];this.path.push(r),this.points.push([r.x.animVal.value,r.height.animVal.value?r.y.animVal.value+r.height.animVal.value:0])}}},t.prototype.sonify=function(){for(var e=0;e<this.points.length;e++){var i=this.context.createOscillator();i.frequency.value=this.points[e][1]?t.BASE_FREQUENCY+10*this.points[e][1]:0,i.type="sine",i.connect(this.context.destination);var n=void 0,o=void 0;this.points.length>20?(n=e/10+.01,o=e/10+.1):(n=e/2+.01,o=e/2+.5),i.start(this.context.currentTime+n),i.stop(this.context.currentTime+o)}},t.prototype.smooth=function(){if(this.points.length){for(var e=[this.points[0]],i=0;i<this.points.length-1;i++){for(var n=this.points[i][0],o=this.points[i][1],r=this.points[i+1][0],s=this.points[i+1][1],a=Math.abs(n-r)/t.SMOOTH_VALUE,c=Math.abs(o-s)/t.SMOOTH_VALUE,u=Math.sign(s-o),l=1;l<t.SMOOTH_VALUE;l++)e.push([n+l*a,o+u*l*c]);e.push([r,s])}this.points=e}},t.BASE_FREQUENCY=300,t.SMOOTH_VALUE=4,t}();e.Sonify=o},function(t,e,i){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.ViewBox=e.ZoomOptions=void 0;var r=i(0),s=i(15),a=function(){};e.ZoomOptions=a;var c=function(){function t(t){this.svg=t,this.focusgroups=new Map,this.defaultZoomOptions={xPad:this.svg.width.baseVal.value/5,yPad:this.svg.height.baseVal.value/5,duration:100,delay:10,wait:0,callback:function(){}},this.reset()}return t.prototype.reset=function(){this.setViewBox_(s.Bbox.fromSvgRect(this.svg.getBBox()))},t.prototype.setClass=function(t,e){for(var i=0;i<t.length;i++)r.classList.add(t[i],e)},t.prototype.clearClass=function(t,e){for(var i=0;i<t.length;i++)r.classList.remove(t[i],e)},t.prototype.clearActive=function(){var t,e;try{for(var i=n(this.focusgroups),r=i.next();!r.done;r=i.next()){var s=o(r.value,2),a=s[0],c=s[1];this.clearClass(c,a)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.focusgroups.clear()},t.prototype.select=function(t,e){var i=e||"cacc-active",n=this.focusgroups.get(i);n&&this.clearClass(n,i),this.setClass(t,i),this.focusgroups.set(i,t)},t.prototype.zoom=function(t,e){var i=this.focusgroups.get(t);i&&0!==i.length&&this.setViewBox_(s.Bbox.combineBboxes(i),e)},t.prototype.setViewBox_=function(t,e){for(var i=this.completeZoomOptions_(e),n=this.retrieveViewBox_(),o=t.difference(n,i.xPad,i.yPad),r=Math.ceil(i.duration/i.delay),s=o.scale(1/r),a=function(t){return function(){this.svg.setAttribute("viewBox",n.add(s.scale(t)).viewBoxValue())}.bind(this)}.bind(this),c=1;c<=r;c++)setTimeout(a(c),c*i.delay);i.callback&&setTimeout(i.callback,i.wait+i.duration)},t.prototype.completeZoomOptions_=function(t){return t?Object.assign({},this.defaultZoomOptions,t):this.defaultZoomOptions},t.prototype.retrieveViewBox_=function(){try{return s.Bbox.fromSvgViewBox(this.svg.viewBox)}catch(t){return new s.Bbox(0,0,0,0)}},t}();e.ViewBox=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Bbox=void 0;var n=function(){function t(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}return t.fromSvgRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.fromSvgViewBox=function(e){return new t(e.baseVal.x,e.baseVal.y,e.baseVal.width,e.baseVal.height)},t.combineBboxes=function(e){var i=function(t){var e=t.getBBox();if(0===e.x&&0===e.y&&0===e.width&&0===e.height&&t.childNodes&&t.childNodes[0]&&t.childNodes[0].transform){var i=t.childNodes[0],n=void 0,o=void 0,r=void 0,s=void 0;if(i.x&&i.y&&i.width&&i.height)n=i.x.baseVal.value,o=i.y.baseVal.value,r=i.width.baseVal.value,s=i.height.baseVal.value;else{var a=i.getBBox();n=a.baseVal.x,o=a.baseVal.y,r=a.baseVal.width,s=a.baseVal.height}var c=t.ownerSVGElement.createSVGPoint(),u=i.transform.baseVal;c.x=n,c.y=o;for(var l=u.length-1;l>=0;l--)c=c.matrixTransform(u.getItem(l).matrix);e.x=c.x,e.y=c.y,e.width=r,e.height=s}return e},n=t.fromSvgRect(i(e[0]));return 1===e.length?n:e.slice(1).reduce((function(t,e){return t.combine(i(e))}),n)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.width+e.width,this.height+e.height)},t.prototype.difference=function(t,e,i){var n=this.add(t.scale(-1));return e&&(n.x=n.x-e/2,n.width=n.width+e),i&&(n.y=n.y-i/2,n.height=n.height+i),n},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.width*e,this.height*e)},t.prototype.combine=function(e){var i=Math.min(this.x,e.x),n=Math.min(this.y,e.y);return new t(i,n,Math.max(this.x+this.width,e.x+e.width)-i,Math.max(this.y+this.height,e.y+e.height)-n)},t.prototype.viewBoxValue=function(){return this.x+" "+this.y+" "+this.width+" "+this.height},t}();e.Bbox=n},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.KeyExplorer=void 0;var r=i(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.setupControls=function(){var t=function(t,e){var i=e();i.length>0&&(this.activeElement=i[0],this.updateMessage(this.activeElement.getSpeech()),this.explorer.magnifier.magnifier.update(this.activeElement)),t.preventDefault()}.bind(this);this.registerEvent(this.molecule.node,r.EventType.KEYDOWN,function(e){switch(e.keyCode){case r.KeyCodes.DOWN:case r.KeyCodes.D:t(e,function(){return this.activeElement.getDown()}.bind(this));break;case r.KeyCodes.UP:case r.KeyCodes.E:t(e,function(){return this.activeElement.getUp()}.bind(this));break;case r.KeyCodes.RIGHT:case r.KeyCodes.F:t(e,function(){return this.activeElement.getRight()}.bind(this));break;case r.KeyCodes.LEFT:case r.KeyCodes.S:t(e,function(){return this.activeElement.getLeft()}.bind(this))}return e.stopPropagation(),!1}.bind(this))},e.prototype.removeControls=function(){this.explorer.magnifier.viewBox.clearActive()},e.prototype.getActivationKey=function(){return r.KeyCodes.A},e}(i(6).AbstractExplorer);e.KeyExplorer=s},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.MenuExplorer=void 0;var r=i(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.setupControls=function(){var t=this.molecule.createElement("ul");t.classList.add("cacc-controls"),t.setAttribute("role","navigation"),this.control_=t;var e=function(t,e){var i=e();i.length>0&&(this.activeElement=i[0],this.updateMessage(this.activeElement.getSpeech()),this.explorer.magnifier.magnifier.update(this.activeElement))}.bind(this),i=function(t,i){this.registerEvent(t,r.EventType.KEYDOWN,(function(t){return t.keyCode!==r.KeyCodes.ENTER&&t.keyCode!==r.KeyCodes.SPACE||(e(t,i),t.preventDefault(),t.stopPropagation()),!1})),this.registerEvent(t,r.EventType.CLICK,(function(t){return e(t,i),t.stopPropagation(),!1}))}.bind(this);i(this.makeButton_("Down",t),function(){return this.activeElement.getDown()}.bind(this)),i(this.makeButton_("Up",t),function(){return this.activeElement.getUp()}.bind(this)),i(this.makeButton_("Right",t),function(){return this.activeElement.getRight()}.bind(this)),i(this.makeButton_("Left",t),function(){return this.activeElement.getLeft()}.bind(this))},e.prototype.addControls=function(){var t=this.molecule.node.querySelector(".cacc-message");t?this.molecule.node.insertBefore(this.control_,t):this.molecule.node.appendChild(this.control_)},e.prototype.removeControls=function(){this.explorer.magnifier.viewBox.clearActive(),this.control_.parentNode.removeChild(this.control_)},e.prototype.getActivationKey=function(){return r.KeyCodes.B},e.prototype.makeButton_=function(t,e){var i=this.molecule.createElement("li");return i.setAttribute("role","button"),i.setAttribute("aria-controls",this.message.getAttribute("id")),i.classList.add("cacc-button"),i.setAttribute("tabindex","0"),i.setAttribute("title",t),i.appendChild(document.createTextNode(t)),e.appendChild(i),i},e}(i(6).AbstractExplorer);e.MenuExplorer=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Molecule=void 0;var n=i(0),o=i(19),r=function(){function t(t,e,i){this.node=t,this.svg=e,this.cml=i,this.id=n.getId(),n.classList.add(this.svg,this.id),n.classList.add(this.cml,this.id),this.cmlStructure=new o.CML(this.cml),this.topLevelDescription=this.cmlStructure.getRootElement().getSpeech(),this.combine_()}return t.prototype.createElement=function(t){var e=document.createElement(t);return e.classList.add(this.id),e},t.prototype.combine_=function(){this.cmlStructure.getMap().forEach(function(t){var e=this.svg.getElementById(t.getId());e&&t.setDrawnElement(e)}.bind(this))},t}();e.Molecule=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CML=void 0;var n=i(20),o=i(21),r=i(23),s=i(27),a=i(28),c=function(){function t(t){this.cmlDocument=t,this.root=null,this.map=new n.Diagram(o.Languages.createLanguages(t)),this.initMap_()}return t.prototype.getMap=function(){return this.map},t.prototype.getRootElement=function(){return this.root||(this.root=this.map.find((function(t){return!(t instanceof a.Bond||t.up)}))),this.root},t.prototype.initMap_=function(){for(var t=this.cmlDocument.querySelectorAll("annotations > annotation"),e=0,i=void 0;i=t[e];e++){var n=i.firstElementChild;if(n){var o=void 0;switch(n.localName.toLowerCase()){case"atom":case"active":o=new r.Atom(i,this.map),this.map.set(o.getKey(),o);break;case"bond":case"passive":o=new a.Bond(i,this.map),this.map.set(o.getId(),o);break;case"atomset":case"grouped":o=new s.AtomSet(i,this.map),this.map.set(o.getId(),o)}}}this.map.forEach(function(t){t.complete()}.bind(this))},t}();e.CML=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Diagram=void 0;var n=function(){function t(t){this.diagram_={},this.languages_=t}return t.prototype.set=function(t,e){this.diagram_[t]=e},t.prototype.get=function(t){return this.diagram_[t]},t.prototype.forEach=function(t){for(var e in this.diagram_)t.call(this,this.diagram_[e])},t.prototype.find=function(t){for(var e in this.diagram_){var i=this.diagram_[e];if(t.call(this,i))return i}return null},t.prototype.translate=function(t){return this.languages_?this.languages_.translate(t):t},t.prototype.nextLanguage=function(){return this.languages_?(this.languages_.nextLanguage(),this.languages_.active):null},t}();e.Diagram=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Languages=void 0;var n=i(22),o=function(){function t(t){this.cmlDocument=t,this.languages={},this.insertLanguages(),this.active=this.defaultActive()}return t.createLanguages=function(e){return 0===e.querySelectorAll("messages").length?null:new t(e)},t.prototype.insertLanguages=function(){for(var t=this.cmlDocument.querySelectorAll("messages"),e=0,i=void 0;i=t[e];e++){var o=i.querySelector("language");o&&(this.languages[o.textContent]=new n.Language(i))}},t.prototype.defaultActive=function(){return this.languages.en?"en":Object.keys(this.languages)[0]},t.prototype.translate=function(t){return this.languages[this.active].translate(t)},t.prototype.nextLanguage=function(){var t=Object.keys(this.languages),e=t.indexOf(this.active)+1;this.active=t.length>e?t[e]:t[0]},t}();e.Languages=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Language=void 0;var n=i(0),o=function(){function t(t){this.cmlDocument=t,this.messages={},this.language=this.getLanguage(),this.insertMessages()}return t.prototype.getLanguage=function(){var t=this.cmlDocument.querySelector("language");return t?t.textContent:""},t.prototype.insertMessages=function(){for(var t=this.cmlDocument.querySelectorAll("message"),e=0,i=void 0;i=t[e];e++)this.messages[n.getAttribute(i,"msg")]=i.textContent},t.prototype.translate=function(t){return this.messages[t]},t}();e.Language=o},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Atom=void 0;var r=i(0),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speech="",e}return o(e,t),e.prototype.getSpeech=function(){if(this.link){var t=this.getUpperNeighbour_(),e=t?t.getSpeech():"",i=[];return this.neighbourhood.forEach((function(t){"external"!==t.location&&i.push(t.getSpeech())})),this.speech=e+" "+i.join(" "),this.speech}var n=this.neighbourhood.map((function(t){return t.getSpeech()})).join(" "),o=this.getMessage();return this.speech=this.getDiagram().translate(o)+" "+n,this.speech},e.prototype.getDrawnElements=function(){if(this.drawnElements)return this.drawnElements;this.drawnElements=[];var t=this.getDrawnElement();t&&this.drawnElements.push(t);for(var e=this.getAnnotation().querySelectorAll("component *"),i=0;i<e.length;i++){(t=this.getDiagram().get(r.getTextContent(e[i])).getDrawnElement())&&-1===this.drawnElements.indexOf(t)&&this.drawnElements.push(t)}return this.drawnElements},e.prototype.getUpperNeighbour_=function(){for(var t=0,e=void 0;e=this.up.neighbourhood[t];t++)if(-1!==e.via().map((function(t){return t.getPosition()})).indexOf(this.position))return e;return null},e}(i(5).NeighbourHood);e.Atom=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChemObj=void 0;var n=i(0),o=function(){function t(t,e){this.annotation_=t,this.diagram_=e,this.drawnElements=null,this.up=null,this.down=[],this.link=!1,this.drawn_=null,this.id_=this.getId_(),this.parent_=this.getParent_(),this.position=this.getPosition_()}return t.prototype.getAnnotation=function(){return this.annotation_},t.prototype.getDiagram=function(){return this.diagram_},t.prototype.getId=function(){return this.id_},t.prototype.setDrawnElement=function(t){this.drawn_=t},t.prototype.getDrawnElement=function(){return this.drawn_},t.prototype.getDrawnElements=function(){return this.drawnElements||(this.drawnElements=[],this.drawn_&&this.drawnElements.push(this.drawn_)),this.drawnElements},t.prototype.complete=function(){if(this.parent_){var t=this.getDiagram().get(this.parent_);this.up=t,t.down.push(this)}},t.prototype.getParent=function(){return this.parent_},t.prototype.getKey=function(){return this.id_+this.parent_},t.prototype.getUp=function(){return this.up?[this.up]:[]},t.prototype.getDown=function(){return this.down},t.prototype.getRight=function(){if(!this.up)return[];var t=this.up.getDown(),e=t.indexOf(this);if(t.length>e+1){var i=t[e+1];return i.position?[i]:[]}return[]},t.prototype.getLeft=function(){if(!this.up)return[];var t=this.up.getDown(),e=t.indexOf(this);if(e>0){var i=t[e-1];return i.position?[i]:[]}return[]},t.prototype.getId_=function(){var t=this.getAnnotation().firstElementChild;return t?t.textContent:""},t.prototype.getParent_=function(){var t=this.getAnnotation().querySelector("parents > *");return t?n.getTextContent(t):""},t.prototype.getPosition_=function(){return parseInt(n.getTextContent(this.getAnnotation().querySelector("position")),10)},t}();e.ChemObj=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Neighbour=void 0;var n=i(0),o=i(26),r=function(){function t(t,e){this.from_=t,this.annotation_=e,this.speech=null,this.speech2=null;var i=n.children(this.annotation_);this.to_=this.from_.getDiagram().get(n.getTextContent(i[0])),this.via_=i.slice(1).map(function(t){return new o.Via(this,t)}.bind(this)),this.location=this.annotation_.getAttribute("sre:location")||""}return t.prototype.from=function(){return this.from_},t.prototype.to=function(){return this.to_},t.prototype.via=function(){return this.via_},t.prototype.getSpeech=function(){return this.from_.getDiagram().translate(this.getMessage())},t.prototype.getMessage=function(){if(n.EXPERT_MODE){if(this.speech2)return this.speech2;if(this.speech2=n.getAttribute(this.annotation_,"speech2"),this.speech2)return this.speech2}return this.speech||(this.speech=n.getAttribute(this.annotation_,"speech")),this.speech},t}();e.Neighbour=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Via=void 0;var n=i(0),o=function(){function t(t,e){this.neighbour_=t,this.annotation_=e,this.type_=n.getAttribute(this.annotation_,"type");var i=n.children(this.annotation_);this.connectedBy_=this.getConnectedBy_(i[0]),this.connectedBy_.link=!0,this.position_=parseInt(n.getTextContent(i[1]),10)}return t.prototype.getDrawnElements=function(){return this.connectedBy_.getDrawnElements()||[]},t.prototype.getType=function(){return this.type_||""},t.prototype.getPosition=function(){return this.position_},t.prototype.getConnectedBy_=function(t){var e=this.neighbour_.from().getDiagram(),i=n.getTextContent(t),o=e.get(i);return o||e.get(i+this.neighbour_.from().getId())},t}();e.Via=o},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.AtomSet=void 0;var r=i(0),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getDrawnElements=function(){if(this.drawnElements)return this.drawnElements;this.drawnElements=[];var t={},e=function(e){t[e.id]||(t[e.id]=!0,this.drawnElements.push(e))},i=this.getDrawnElement();i&&e(i);for(var n=0,o=void 0;o=this.getDown()[n];n++)o.getDrawnElements().forEach(e.bind(this)),(i=o.getDrawnElement())&&e(i);var s=this.getAnnotation().querySelectorAll("component bond,passive");for(n=0;n<s.length;n++){var a=r.getTextContent(s[n]);(o=this.getDiagram().get(a)).getDrawnElements().forEach(e.bind(this)),(i=o.getDrawnElement())&&e(i)}return this.drawnElements},e}(i(5).NeighbourHood);e.AtomSet=s},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Bond=void 0;var r=i(0),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ends=[],e}return o(e,t),e.prototype.complete=function(){for(var t=this.getAnnotation().querySelectorAll("component > atom,active"),e=0,i=void 0;i=t[e];e++){var n=this.getDiagram().get(r.getTextContent(i));n&&this.ends.push(n)}},e}(i(5).NeighbourHood);e.Bond=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fromUri_=e.getUrlParameters_=e.getParam_=e.getData_=e.getMol_=e.forDocument=void 0;var n=i(30);function o(t){t.querySelector("div.svg")?(t.setAttribute("has-svg","true"),n.rewriteTransformations(t.querySelector("div.svg > svg"))):r(t,"svg","data-src",".svg"),t.querySelector("div.cml")?t.setAttribute("has-cml","true"):r(t,"cml","data-cml",".xml")}function r(t,e,i,o){var r=t.getAttribute(i)||s(t,i,o);r?c(r,(function(i){if(i){t.setAttribute("has-"+e,"true");var o=document.createElement("div");o.classList.add(e),o.setAttribute("aria-hidden","true"),"svg"===e&&n.rewriteTransformations(i),o.appendChild(i.documentElement),t.appendChild(o)}else t.setAttribute("has-"+e,"false")})):t.setAttribute("has-"+e,"false")}function s(t,e,i){if(!t.id)return null;var n=a()[t.id];return n?(n+=i,t.setAttribute(e,n),n):null}function a(){for(var t,e={},i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<i.length;n++)e[(t=i[n].split("="))[0]]=t[1];return e}function c(t,e){if("file:"!==location.protocol){var i=new DOMParser,n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(i.parseFromString(n.responseText,"text/xml"))},n.open("GET",t,!0),n.send(null)}else e(null)}e.forDocument=function(t){for(var e=t||document,i=Array.from(e.querySelectorAll(".ChemAccess-element")),n={},r=0,s=void 0;s=i[r];r++)o(s),s.id||(s.id="ChemAccess-element"+r),n[s.id]=s;return n},e.getMol_=o,e.getData_=r,e.getParam_=s,e.getUrlParameters_=a,e.fromUri_=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.transformNodes=e.purgeTransforms=e.envelopNode=e.transformNode=e.rewriteTransformations=void 0;var n=i(0);function o(t){var e=t,i=[];do{var n=e.getAttribute("transform");n&&i.unshift(n),e=e.parentNode}while("svg"!==e.tagName);return t.setAttribute("transform",i.join(" ")),t}function r(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g"),i=t.getAttribute("id");return i&&(e.setAttribute("id",i),t.removeAttribute("id")),t.parentNode.replaceChild(e,t),e.appendChild(t),e}function s(t){var e=t;do{(e=e.parentNode).removeAttribute("transform")}while("svg"!==e.tagName)}function a(t){t.forEach(o),t.forEach(s),t.filter((function(t){return t.hasAttribute("id")})).forEach(r)}e.rewriteTransformations=function(t){var e=n.toArray(t.querySelectorAll("text,polyline,line,rect,polygon,use,path"));return a(e),e},e.transformNode=o,e.envelopNode=r,e.purgeTransforms=s,e.transformNodes=a}])}));